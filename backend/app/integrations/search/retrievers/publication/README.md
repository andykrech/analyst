# Publication retrievers

Инфраструктура поиска научных публикаций для проекта «Аналитик». Адаптеры к внешним API (OpenAlex, в перспективе Crossref, Lens и др.) возвращают поток квантов типа `publication` без дедупликации и без логики мультиязычности.

## Архитектура

- **PublicationRetriever** (оркестратор) в будущем будет вызывать несколько адаптеров по одному запросу, агрегировать результаты и при необходимости делать дедуп на верхнем уровне.
- **Адаптер публикаций** (например `OpenAlexPublicationAdapter`):
  - принимает полный **QueryModel** (AND/OR/MUST/NOT, скобки);
  - принимает **обязательный** параметр `language` (один язык на вызов);
  - принимает **обязательный** параметр `theme_id` и опциональный `run_id` — передаются из верхнего слоя поиска (контекст retriever'а), по theme_id определяется контекст поискового запроса;
  - принимает **опциональный** параметр `time_slice` (фильтр по дате публикации);
  - возвращает список квантов (`InfoQuantum` / `QuantumCreate`);
  - **не** выполняет дедупликацию;
  - **не** занимается несколькими языками (вызов на один язык);
  - **не** знает о других источниках.

На текущем шаге реализован только адаптер OpenAlex.

## Обязательность language

Параметр `language` обязателен: адаптер строит запрос и локальные фильтры по тексту термов для этого языка. При отсутствии `language` адаптер выбрасывает `ValueError`.

## Поддержка time_slice

Если передан `TimeSlice` (published_from, published_to), он преобразуется в фильтры OpenAlex:

- `filter=from_publication_date:YYYY-MM-DD,to_publication_date:YYYY-MM-DD`

## Отсутствие дедупа

Адаптер возвращает все подходящие по запросу и локальным MUST/EXCLUDE результаты в рамках лимита. Дедупликация между источниками и между запросами — зона ответственности оркестратора (PublicationRetriever) или верхнего слоя (Executor/Service).
